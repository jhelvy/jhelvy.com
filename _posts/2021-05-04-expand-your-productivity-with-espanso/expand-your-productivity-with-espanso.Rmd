---
title: "Expand your productivity with espanso"
description: |
  How I use text snippets with espanso to automate common text chunks
author: John Paul Helveston
date: 05-04-2021
preview: "espanso.svg"
categories:
  - productivity
  - R
draft: true
output:
  distill::distill_article:
    self_contained: false
    toc: true
    toc_depth: 1
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  fig.path = "figs/",
  fig.width = 7.252,
  fig.height = 4,
  comment = "#>",
  fig.retina = 3,
  R.options = list(width = 60)
)

library(tidyverse)
library(knitr)

df <- read_csv(here::here(
    "_posts", "2021-05-04-expand-your-productivity-with-espanso",
    "expansions.csv"))
tables <- split(df, df$type)
```

<center>
<img src="espanso.svg" width=100%>
</center>

I recently discovered a wonderfully useful little program called [espanso](https://espanso.org/) -- a "text expander" that I now use on a daily basis. Text expander programs do what you might expect: they "expand" short snippets of text into longer, more complex strings of text. There are lots of these programs out there, such as [Typinator](https://www.ergonis.com/products/typinator/), or the creatively-named [textexpander](https://textexpander.com/) (macOS even has a [build-in expander](https://www.goodmanconsulting.com/hottips/2018/1/31/speed-up-mac-and-ios-typing-with-text-expansion)). But in general I prefer to use open source software whenever possible (the espanso [source code](https://github.com/federico-terzi/espanso) is on GitHub), and especially when using software that tracks the text you type (imagine how easy it would be to grab passwords with this type of software). Plus espanso is free ðŸ˜„.

But more than anything, I find espanso remarkably simple, flexible, and easy to customize. So far, it has integrated quite nicely into my day-to-day workflow. Here are some examples.

# Quick overview

> **Note**: I'm skipping a lot of details about installation, etc. because it's all there in the espanso [documentation](https://espanso.org/docs/). It's simple and excellent -- check it out.

To set a text expansion, all you have to do is edit the `default.yml` file. You can find it's location with this in the terminal:

```{r, eval=FALSE}
espanso path
```

Once you've opened up the `default.yml` file, set an expansion like this:

```{r, eval=FALSE}
  # Simple text replacement
  - trigger: ":test"
    replace: "Hello World!"
```

Now anytime I type `:test`, the text will expand to `Hello World!`. Pretty cool! For the rest of this post, I'll highlight some of the other ways I use espanso.

For reference, I included a copy of *most* of my settings at the [end of this post](). I took out some snippets with personal information like the link to my personal Zoom room, etc.

> **Note**: It's probably a really bad idea to put passwords you use in your espanso settings, so don't do that!

# Some basic expansions

## Personal information

I often have to type personal information (e.g. my name, title, email, etc.) into forms. Here are some expansions I use for that:

```{r, echo=FALSE}
tables$personal %>%
    select(-type) %>%
    kable()
```

## Email sign offs

I usually sign off my emails with "Cheers," + either "John", "JP", or "Professor Helveston," depending on the recipient. I now quickly get these phrases with the following triggers:

```{r, echo=FALSE}
tables$signoff %>%
    select(-type) %>%
    kable()
```

## URLs

I used to rely on bookmarks for lots of common sites I visit, but I often need to copy-paste the actual url to those sites (e.g. if I'm sending the link to someone else). Before, I had to open up my browser, navigate to the site, then copy the url. Now I can just type a few keys ðŸŽ‰! I start each of these with `"//"`, for example:

```{r, echo=FALSE}
tables$url %>%
    select(-type) %>%
    kable()
```

My most used url expansion this year was `//zoom` to expand to the url to my personal zoom room! ðŸš€

# Code

This is where things start getting _really_ helpful. I write lots of common code snippets for a wide variety of use cases, and the ability to automate these _globally_ (i.e. not just in a code IDE) on my computer is an incredible help. The time savings don't come from avoiding the extra keystrokes -- they come from avoiding _typos_! It's all too easy to miss a tiny symbol or letter in a chunk of code which then results in several minutes (if not longer) of searching for the bug.

For example, let's say I want to insert some html to center an image. I might start with a template code chunk like this:

```{html, eval=FALSE}
<center>
<img src="" width=500>
</center>
```

Rather than type this by hand every time, I can get the whole block with `"hhimg"` with this trigger:

```{r eval=FALSE}
  - trigger: "hhimg"
    replace: "<center>\n<img src=\"$|$\" width=500>\n</center>"
```

A couple things to note here:

1. I decided to use a convention where all of my "code" triggers start with a double of the first letter of the code language. So html expansions all start with `hh`, R expansions start with `rr`, python with `pp`, etc. Hence, in my mind the trigger `hhimg` is "html img".
2. By inserting the `$|$` symbols inside the src command, the cursor will automatically jump to that spot once the expansion is complete, allowing me to quickly type in the name of the path to the image I want to insert.

## R code

Since I use R more than any other language, I've come up with a lot of R-specific shortcuts. But before I dive into them, a quick side note:

One important modification I learned (thanks to some [help](https://www.reddit.com/r/espanso/comments/n3wigg/snippets_only_partially_expand_in_rstudio/) on the [espanso Reddit community](https://www.reddit.com/r/espanso/)) is that if you're working in RStudio, the expansions don't quite work correctly on their own (I believe it might have something to do with RStudio's autofill feature). To fix it, I had to insert the `force_clipboard: true` setting into **each** espanso expansion. For example, in my snippet to read in a CSV file, I inserted this option between the trigger and expansion text like this:

```{r eval=FALSE}
  - trigger: "rrcsv"
    force_clipboard: true
    replace: "read_csv($|$)"
```

Okay with that in mind, I'll highlight a few R expansions I use a lot. I've organized this based on my common workflow for exploring data:

- Add a setup chunk (if working in Rmd)
- Load libraries & data
- Wrangle data 
- Visualize

### Add a setup chunk

I usually include a "setup" chunk in most of my Rmd files, but it's really hard to remember all the specific details for various settings, so I made a dedicated expansion just for this. With this expansion, I can insert my whole defaul setup chunk with `rrsetup`:

````markdown
  - trigger: "rrsetup"
    force_clipboard: true
    replace: |
              `r ''````{r setup, include=FALSE}
              knitr::opts_chunk$set(
                warning = FALSE,
                message = FALSE,
                fig.path = "figs/",
                fig.width = 7.252,
                fig.height = 4,
                comment = "#>",
                fig.retina = 3
              )
              ```
````

### Load libraries & data

I use some simple shortcuts to load individual libraries, like `rrtidy` to expand to `library(tidyverse)`. But I also set up an expansion to load some of my most often used libraries and settings. By typing `rrstart`, I get this expansion:

```{r eval=FALSE}
library(tidyverse)
library(cowplot)
options(dplyr.width = Inf)
```

With my libraries loaded, I then read in my data. I use `rrcsv` to expand to `read_csv($|$)`, `rrex` to expand to `read_excel($|$)`, and `rrhere` to expand to `here::here($|$)`, which I use to define paths to files (**side note**: if you don't alread, you should definitely try [using the {here} package to define paths](https://malco.io/2018/11/05/why-should-i-use-the-here-package-when-i-m-already-using-projects/#:~:text=The%20here%20package%20bottles%20up,needing%20to%20think%20about%20it.)).

### Wrangle data 



`"rrgs"`
`"group_by($|$) %>%\nsummarise()\n"`

`"rrgm"`
`"group_by($|$) %>%\nmutate()\n"`


### Visualize




`"rrgg"`
`"ggplot($|$) +\n"`

`"rrsy"`
`"scale_y_continuous($|$expand = expansion(mult = c(0, 0.05))) +"`

`"rrsx"`
`"scale_x_continuous($|$expand = expansion(mult = c(0, 0.05))) +"`

`"ggcol"`
`"ggplot() +\ngeom_col(aes(x = $|$, y = , fill = ))\n"`

`"ggpoint"`
`"ggplot() +\ngeom_point(aes(x = $|$, y = ))\n"`





# Other stuff

## Dates

These come from the espanso documentation, but they're super useful:

```{r eval=FALSE}
  - trigger: ":date"
    force_clipboard: true
    replace: "{{today}}"
    vars:
      - name: today
        type: date
        params:
          format: "%Y-%m-%d"

  - trigger: ":time"
    force_clipboard: true
    replace: "{{time}}"
    vars:
      - name: time
        type: date
        params:
          format: "%H:%M"
```

## Paste clipboard contents as plain text

This is probably my favorite little hack. Often times, I want to copy-paste a snippet of text from one source to another, but when I go to paste it somewhere else, it retains all of the text formatting from the original source. My previous work around was to paste it first into a text editor (e.g. Sublime Text), then re-copy-paste it from there with the formatting now stripped away. But since espanso has support for working with your "clipboard", I found I could simply paste the plain text by using the `force_clipboard: true`. I use `ppp` as the trigger for this:

```{r, eval=FALSE}
  - trigger: "ppp"
    force_clipboard: true
    replace: "{{clipboard}}"
    vars:
      - name: "clipboard"
        type: "clipboard"
```

## Open things

You can run terminal commands using an espanso trigger. I haven't found too many ways to use this feature, but it is helpful for opening files or folders that may be buried deep down in some folder structure. For example, I use the `:espanso` trigger to open the `default.yml` file to edit my espanso settings:

```{r, eval=FALSE}
  - trigger: ":espanso"
    replace: "{{output}}"
    vars:
      - name: output
        type: shell
        params:
          cmd: "open '/Users/jhelvy/gh/espanso/espanso/default.yml'"
```

# Packages

There are already a lot of great espanso [packages](https://hub.espanso.org/). My favorite so far is the [emoji package](https://hub.espanso.org/packages/all-emojis/). It's super convenient, but I often forget the name of specific emojis, so I made another expansion to the url to an emoji cheat sheet site:

```{r, eval=FALSE}
  - trigger: "//emo"
    force_clipboard: true
    replace: "https://www.webfx.com/tools/emoji-cheat-sheet/"
```

# Copy of my `default.yml` file

Here's what I have in my `default.yml` file (for now...again, I removed a few that had some personal information)

```{r, eval=FALSE}

```

